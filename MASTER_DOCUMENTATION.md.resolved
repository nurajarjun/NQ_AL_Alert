# NQ-AI-Alerts - Complete System Documentation

**Last Updated:** 2026-01-20 00:39 EST  
**Project Location:** [d:\Google\.gemini\antigravity\scratch\NQ-AI-Alerts](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts)  
**GitHub Repository:** https://github.com/nurajarjun/NQ_AL_Alert

---

## üìã Table of Contents

1. [System Overview](#system-overview)
2. [Credentials & Configuration](#credentials--configuration)
3. [Infrastructure](#infrastructure)
4. [Deployment History](#deployment-history)
5. [Current Status](#current-status)
6. [Known Issues & Solutions](#known-issues--solutions)
7. [Next Steps](#next-steps)
8. [Reference Commands](#reference-commands)

---

## System Overview

### Purpose
AI-powered real-time trading alert system for NQ (Nasdaq-100 E-mini) futures with:
- Google Gemini AI analysis
- XGBoost ML predictions (framework ready, needs training)
- Multi-symbol support (NQ, TQQQ, SQQQ, SOXL, SOXS)
- TradingView webhook integration
- Telegram notifications

### Architecture
```
TradingView ‚Üí Webhook ‚Üí Oracle Cloud (FastAPI) ‚Üí AI Analysis ‚Üí Telegram
                              ‚Üì
                        Context Layer (News, Sentiment, Market Data)
                              ‚Üì
                        Decision Layer (Gemini AI)
                              ‚Üì
                        ML Layer (XGBoost - not yet trained)
```

### Tech Stack
- **Backend:** FastAPI (Python)
- **AI:** Google Gemini 1.5 Flash
- **ML:** XGBoost (framework ready)
- **Notifications:** Telegram Bot API
- **Deployment:** Docker on Oracle Cloud
- **CI/CD:** GitHub Actions

---

## Credentials & Configuration

### üîê Local Environment (.env)

**File Location:** [d:\Google\.gemini\antigravity\scratch\NQ-AI-Alerts\.env](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/.env)

```env
# Telegram Configuration
TELEGRAM_BOT_TOKEN=8593056133:AAHs1NOBNAa5uV_3iHhTBxh0GINIqzxDHwE
TELEGRAM_CHAT_ID=1979620652

# AI Configuration
GOOGLE_API_KEY=AIzaSyBtdqI1DonmbuFk-8fybF7tB95GgjVWrqY

# Ngrok Configuration
NGROK_AUTHTOKEN=37mLkS6zGDtRQRVaoABCduCrAI0_7MTWdSs8Ys84znX9xqgSP

# Settings
DEBUG=True
LOG_LEVEL=INFO
AUTONOMOUS_MODE=false
```

### üîë GitHub Secrets (Required for Auto-Deploy)

**Configure at:** https://github.com/nurajarjun/NQ_AL_Alert/settings/secrets/actions

| Secret Name | Value | Purpose |
|-------------|-------|---------|
| `ORACLE_SSH_KEY` | See below | SSH private key for Oracle instance |
| `ORACLE_HOST` | `150.136.85.235` | Oracle Cloud instance IP |
| `ORACLE_USER` | `ubuntu` | SSH username |
| `TELEGRAM_BOT_TOKEN` | `8593056133:AAHs1NOBNAa5uV_3iHhTBxh0GINIqzxDHwE` | Main bot token |
| `TELEGRAM_CHAT_ID` | `1979620652` | Main chat ID |
| `DEPLOY_TELEGRAM_TOKEN` | `8593056133:AAHs1NOBNAa5uV_3iHhTBxh0GINIqzxDHwE` | Deployment notifications |
| `DEPLOY_TELEGRAM_CHAT` | `1979620652` | Deployment chat |
| `GEMINI_API_KEY` | `AIzaSyBtdqI1DonmbuFk-8fybF7tB95GgjVWrqY` | Gemini AI key |
| `NEWS_API_KEY` | `not_configured` | News API (placeholder) |

### üîê Oracle SSH Key

**Location:** [C:\Users\himanika\.ssh\oracle-nq-key](file:///C:/Users/himanika/.ssh/oracle-nq-key)

**Public Key Location:** `C:\Users\himanika\.ssh\oracle-nq-key.pub`

**Alternative Location:** [d:\Google\.gemini\antigravity\scratch\NQ-AI-Alerts\Key\ssh-key-2026-01-16.key](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/Key/ssh-key-2026-01-16.key)

**Format:** OpenSSH Private Key (50 lines, 3389 bytes)

**Usage:**
```bash
ssh -i C:\Users\himanika\.ssh\oracle-nq-key ubuntu@150.136.85.235
```

### üì± Telegram Bot Details

**Bot Name:** NQ AI Alert Bot  
**Bot Token:** `8593056133:AAHs1NOBNAa5uV_3iHhTBxh0GINIqzxDHwE`  
**Chat ID:** `1979620652`  
**Created via:** @BotFather

---

## Infrastructure

### Oracle Cloud Instance

**IP Address:** `150.136.85.235`  
**OS:** Ubuntu  
**Username:** `ubuntu`  
**SSH Port:** 22  
**Application Port:** 8001

**Known Host Keys:**
```
150.136.85.235 ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIIwQWsRt1cC9w2dlTw3kyLI37/9TBBIcW5N8YOjQRD9X
150.136.85.235 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCyMVYxqqeR9jyLh8bqVnjNXCvZ4h6hc88yZyYqF7T28RCY/MAfFqB4ZCNpTJnvWP0OaVupxT4CE5pdzEgTq8cmw3FZZY5NwCWgQMfvL0hYz5+oE8e3RDM0qVWZ919HvGhFqMDBElGCC3qfOQ8/TdQeUEEC5rLVuWbptaTxtP5QtR08e9QVzMr+q4sYfgHfw/CwtZtUtuGZrccPZb3Ie1mJb1aQQJow3Pv2J6tg2UZ9uJYv0ew+YHOUJ7YYM8LmbiWNoHC6JPnZ0tZBsJTN7e/iNCyONEbAHbCYQc7ukR1syS0CU1isQ9FdJCIdeugmE/gBirf7GZMI5VbKbVEzAWggsbeeCxg1Vg6rWNuXA77p72afzZ+idMM0BY4qmBmH1UeWsCW+dLSczwzRtY+3zXAsfA2ijU1UtyPx3aqBWKTY2lidN3/D4TdhIv38oLQ4afkNk2K3DUbFGPZzoC1BHpr1Cfs2eJXkSe3Dt1Xf71ZCqOiCY/obJGYsPFMJtJU+xzM=
150.136.85.235 ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBD2HRhdJVmQrgXBMh1+C+w4IWVW227DU2x8HQndA8seV4NOifTyw1vhnnRq9JyA4e+TledLIOMkOcr4E8CFTwGs=
```

**Stored in:** [C:\Users\himanika\.ssh\known_hosts](file:///C:/Users/himanika/.ssh/known_hosts)

### Docker Configuration

**File:** [docker-compose.yml](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/docker-compose.yml)

```yaml
version: '3.8'
services:
  nq-alerts:
    build: .
    container_name: nq-ai-alerts
    ports:
      - "8001:8001"
    environment:
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      - TELEGRAM_CHAT_ID=${TELEGRAM_CHAT_ID}
      - GEMINI_API_KEY=${GEMINI_API_KEY}
      - NEWS_API_KEY=${NEWS_API_KEY}
      - PYTHONUNBUFFERED=1
    volumes:
      - ./ml/models:/app/ml/models
      - ./ml/data:/app/ml/data
      - ./backend/ml/data:/app/backend/ml/data
      - ./:/app
    network_mode: "host"
    restart: unless-stopped
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:8001/" ]
      interval: 60s
      timeout: 10s
      retries: 5
      start_period: 120s
```

**Key Points:**
- Uses `network_mode: "host"` - container shares host network
- Port 8001 exposed directly on host
- 2-minute startup grace period for health checks
- Auto-restart enabled

---

## Deployment History

### GitHub Actions Workflow

**File:** [.github/workflows/auto-deploy.yml](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/.github/workflows/auto-deploy.yml)  
**Workflow Name:** "Complete Auto-Deploy to Oracle Cloud"  
**Trigger:** Push to `main` branch or manual dispatch

### Deployment Timeline

| Run # | Date | Commit | Status | Issue |
|-------|------|--------|--------|-------|
| #1-#5 | Earlier | Various | ‚ùå Failed | Initial setup issues |
| #6-#10 | 2026-01-19 | Various | ‚ùå Failed | SSH connection error |
| #11 | 2026-01-20 | `e906fad` | ‚è≥ Running | Health check in progress |

### Critical Fix (Commit e906fad)

**Problem:** `ssh-keyscan` failing with "Connection closed by remote host"

**Root Cause:** Oracle Cloud firewall blocking GitHub Actions IP addresses

**Solution:** Replace `ssh-keyscan` with hardcoded known host keys

**Changes:**
```yaml
# Before (BROKEN)
ssh-keyscan -H ${{ secrets.ORACLE_HOST }} >> ~/.ssh/known_hosts

# After (FIXED)
echo "${{ secrets.ORACLE_HOST }} ssh-ed25519 AAAAC3NzaC1lZDI1NTE5..." >> ~/.ssh/known_hosts
echo "${{ secrets.ORACLE_HOST }} ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAB..." >> ~/.ssh/known_hosts
echo "${{ secrets.ORACLE_HOST }} ecdsa-sha2-nistp256 AAAAE2VjZHNh..." >> ~/.ssh/known_hosts
chmod 644 ~/.ssh/known_hosts
```

**Result:** SSH connection now successful, deployment proceeding

---

## Current Status

### ‚úÖ Working Components

1. **Local Development**
   - FastAPI server runs locally
   - Telegram notifications working
   - AI analysis (Gemini) functional
   - Environment variables configured

2. **GitHub Integration**
   - Repository: https://github.com/nurajarjun/NQ_AL_Alert
   - Auto-deploy workflow configured
   - SSH connection to Oracle fixed

3. **Credentials**
   - All API keys obtained and working
   - SSH keys configured
   - Telegram bot active

### ‚ö†Ô∏è In Progress

1. **Oracle Cloud Deployment**
   - Workflow Run #11 currently executing
   - SSH connection successful
   - Code deployed to instance
   - Containers restarted
   - Health checks timing out (app startup delay)

### ‚ùå Not Yet Completed

1. **ML Model Training**
   - XGBoost framework ready
   - Historical data download needed
   - Training script: `backend/ml/xgboost_model.py`
   - Expected accuracy: 72-78%

2. **TradingView Integration**
   - Pine Script ready: `tradingview/NQ_AI_Strategy.pine`
   - Webhook URL: `http://150.136.85.235:8001/webhook/tradingview`
   - Needs deployment completion first

3. **End-to-End Testing**
   - Waiting for deployment success
   - Test webhook ‚Üí AI analysis ‚Üí Telegram flow

---

## Known Issues & Solutions

### Issue 1: SSH Connection Failure (FIXED ‚úÖ)

**Symptom:** `ssh-keyscan` fails with "Connection closed by remote host"

**Cause:** Oracle Cloud firewall blocks GitHub Actions IPs

**Solution:** Use hardcoded known host keys in workflow

**Status:** Fixed in commit `e906fad`

### Issue 2: Health Check Timeout (CURRENT ‚è≥)

**Symptom:** Port 8001 returns "Connection refused" during health checks

**Possible Causes:**
1. Application startup takes longer than expected
2. Port configuration issue
3. Application error preventing startup

**Troubleshooting Steps:**
```bash
# SSH into instance
ssh -i C:\Users\himanika\.ssh\oracle-nq-key ubuntu@150.136.85.235

# Check container status
sudo docker-compose -f ~/NQ_AL_Alert/docker-compose.yml ps

# View logs
sudo docker-compose -f ~/NQ_AL_Alert/docker-compose.yml logs --tail=100

# Test endpoint locally
curl http://localhost:8001/

# Check port
sudo netstat -tlnp | grep 8001
```

**Potential Fixes:**
1. Increase health check `start_period` in docker-compose.yml
2. Check application logs for startup errors
3. Verify all environment variables are set
4. Rebuild Docker image if needed

### Issue 3: GitHub Secrets Not Configured (PENDING ‚ö†Ô∏è)

**Status:** User confirmed they have all information but secrets may not be added to GitHub yet

**Required Action:** Add all 9 secrets to GitHub repository settings

**Verification:** Check https://github.com/nurajarjun/NQ_AL_Alert/settings/secrets/actions

---

## Next Steps

### Immediate (Today)

1. **Monitor Deployment**
   - Check workflow status: https://github.com/nurajarjun/NQ_AL_Alert/actions/runs/21160454857
   - Wait for health check completion
   - Verify deployment success/failure

2. **If Deployment Succeeds:**
   ```bash
   # Test endpoint
   curl http://150.136.85.235:8001/
   
   # Expected response
   {"status": "healthy", "service": "NQ AI Alert System"}
   ```

3. **If Deployment Fails:**
   - SSH into Oracle instance
   - Check Docker logs
   - Restart containers if needed
   - Review application errors

### Short-term (This Week)

4. **Train ML Models**
   ```bash
   cd d:\Google\.gemini\antigravity\scratch\NQ-AI-Alerts\backend
   python -m ml.xgboost_model
   ```
   - Downloads 2+ years of NQ data
   - Trains XGBoost classifier
   - Saves model to `ml/models/xgboost_model.pkl`
   - Expected runtime: 1 hour

5. **Configure TradingView**
   - Add Pine Script to chart
   - Set webhook URL: `http://150.136.85.235:8001/webhook/tradingview`
   - Create alert
   - Test with simulated signal

6. **End-to-End Testing**
   ```bash
   # Send test webhook
   curl -X POST http://150.136.85.235:8001/webhook/tradingview \
     -H "Content-Type: application/json" \
     -d '{
       "symbol": "NQ",
       "direction": "LONG",
       "entry": 21880,
       "stop": 21850,
       "target1": 21940,
       "target2": 22000,
       "rsi": 55,
       "atr": 35,
       "volume_ratio": 1.3
     }'
   ```
   - Verify Telegram alert received
   - Check AI analysis quality
   - Validate all data fields

### Medium-term (Next 2 Weeks)

7. **Get News API Key**
   - Sign up: https://newsapi.org/register
   - Add to GitHub secrets
   - Update deployment

8. **Performance Monitoring**
   - Track alert accuracy
   - Monitor AI scores
   - Build pattern database

9. **Security Improvements**
   - Open SSH port properly in Oracle Cloud
   - Configure proper firewall rules
   - Review security best practices

---

## Reference Commands

### Local Development

```bash
# Start local server
cd d:\Google\.gemini\antigravity\scratch\NQ-AI-Alerts\backend
python main.py

# Run tests
python test_telegram_direct.py
python test_ai_system.py

# Train ML model
python -m ml.xgboost_model
```

### Git Operations

```bash
cd d:\Google\.gemini\antigravity\scratch\NQ-AI-Alerts

# Check status
git status

# Commit changes
git add .
git commit -m "Description"
git push origin main

# View history
git log --oneline -10
```

### Oracle Cloud Management

```bash
# SSH into instance
ssh -i C:\Users\himanika\.ssh\oracle-nq-key ubuntu@150.136.85.235

# Once connected:

# Check containers
sudo docker-compose -f ~/NQ_AL_Alert/docker-compose.yml ps

# View logs
sudo docker-compose -f ~/NQ_AL_Alert/docker-compose.yml logs -f

# Restart containers
sudo docker-compose -f ~/NQ_AL_Alert/docker-compose.yml restart

# Rebuild
sudo docker-compose -f ~/NQ_AL_Alert/docker-compose.yml down
sudo docker-compose -f ~/NQ_AL_Alert/docker-compose.yml build --no-cache
sudo docker-compose -f ~/NQ_AL_Alert/docker-compose.yml up -d

# Check environment
cat ~/NQ_AL_Alert/.env

# Test endpoint
curl http://localhost:8001/

# Check port
sudo netstat -tlnp | grep 8001
```

### GitHub Actions

```bash
# View workflows
# https://github.com/nurajarjun/NQ_AL_Alert/actions

# Trigger manual deployment
# Go to Actions ‚Üí Complete Auto-Deploy to Oracle Cloud ‚Üí Run workflow

# View specific run
# https://github.com/nurajarjun/NQ_AL_Alert/actions/runs/[RUN_ID]
```

---

## Important Files & Locations

### Project Structure

```
d:\Google\.gemini\antigravity\scratch\NQ-AI-Alerts\
‚îú‚îÄ‚îÄ .env                          # Local environment variables
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îú‚îÄ‚îÄ auto-deploy.yml       # Main deployment workflow (FIXED)
‚îÇ       ‚îî‚îÄ‚îÄ rollback.yml          # Rollback workflow
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ main.py                   # FastAPI application
‚îÇ   ‚îú‚îÄ‚îÄ ai/                       # AI analysis modules
‚îÇ   ‚îú‚îÄ‚îÄ ml/                       # ML models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ xgboost_model.py     # Training script
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ models/              # Trained models (empty)
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt          # Python dependencies
‚îú‚îÄ‚îÄ tradingview/
‚îÇ   ‚îî‚îÄ‚îÄ NQ_AI_Strategy.pine      # TradingView strategy
‚îú‚îÄ‚îÄ docker-compose.yml            # Docker configuration
‚îú‚îÄ‚îÄ Dockerfile                    # Docker image definition
‚îú‚îÄ‚îÄ setup-oracle.sh               # Oracle setup script
‚îî‚îÄ‚îÄ Key/
    ‚îî‚îÄ‚îÄ ssh-key-2026-01-16.key   # Alternative SSH key location
```

### Configuration Files

- **Local env:** [d:\Google\.gemini\antigravity\scratch\NQ-AI-Alerts\.env](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/.env)
- **SSH key:** [C:\Users\himanika\.ssh\oracle-nq-key](file:///C:/Users/himanika/.ssh/oracle-nq-key)
- **Known hosts:** [C:\Users\himanika\.ssh\known_hosts](file:///C:/Users/himanika/.ssh/known_hosts)
- **Workflow:** [.github/workflows/auto-deploy.yml](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/.github/workflows/auto-deploy.yml)
- **Docker:** [docker-compose.yml](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/docker-compose.yml)

---

## System Capabilities

### Current Features

‚úÖ AI-powered alert analysis (Google Gemini)  
‚úÖ Multi-symbol support (NQ, TQQQ, SQQQ, SOXL, SOXS)  
‚úÖ Telegram notifications  
‚úÖ TradingView webhook integration  
‚úÖ Quality scoring (0-100)  
‚úÖ Risk assessment (LOW/MEDIUM/HIGH)  
‚úÖ Position sizing recommendations  
‚úÖ Multi-timeframe analysis  
‚úÖ Pattern recognition framework  
‚úÖ Economic calendar integration  
‚úÖ Market correlations (QQQ, VIX, Yields)  

### Planned Features

‚è≥ XGBoost ML predictions (needs training)  
‚è≥ News sentiment analysis (needs API key)  
‚è≥ Performance tracking dashboard  
‚è≥ Auto-trading execution  
‚è≥ Backtesting engine  
‚è≥ Risk management system  
‚è≥ Mobile app  

---

## Support & Resources

### Documentation

- **Main README:** [README.md](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/README.md)
- **Deployment Guide:** [DEPLOYMENT_GUIDE.md](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/DEPLOYMENT_GUIDE.md)
- **AI Setup:** [AI_SETUP_GUIDE.md](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/AI_SETUP_GUIDE.md)
- **TradingView Setup:** [TRADINGVIEW_SETUP.md](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/TRADINGVIEW_SETUP.md)
- **Improvements Roadmap:** [IMPROVEMENTS_ROADMAP.md](file:///d:/Google/.gemini/antigravity/scratch/NQ-AI-Alerts/IMPROVEMENTS_ROADMAP.md)

### External Links

- **GitHub Repo:** https://github.com/nurajarjun/NQ_AL_Alert
- **Oracle Cloud:** https://cloud.oracle.com
- **Gemini API:** https://makersuite.google.com/app/apikey
- **News API:** https://newsapi.org
- **Telegram Bot:** @BotFather

---

## Changelog

### 2026-01-20

- ‚úÖ Fixed SSH connection issue in auto-deploy workflow
- ‚úÖ Replaced `ssh-keyscan` with known host keys
- ‚úÖ Committed fix (e906fad) and pushed to main
- ‚úÖ Triggered deployment Run #11
- ‚è≥ Deployment in progress, health checks pending
- üìù Created comprehensive documentation

### 2026-01-19

- ‚ùå Multiple deployment failures (#6-#10)
- üîç Diagnosed SSH connection error
- üìã Identified all required credentials
- üîê Located Oracle SSH keys and instance IP

---

**End of Documentation**

*This document should be updated whenever significant changes are made to the system.*
